<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>üêç –ó–º–µ–π–∫–∞</title>
    <style>
        :root {
            --bg-color: #0f0f13;
            --card-bg: #1f2023;
            --text-color: #ffffff;
            --accent-color: #0088cc;
            --secondary-text: #8a8e97;
            --border-radius: 16px;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            --font-main: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        body {
            font-family: var(--font-main);
            background-color: var(--bg-color);
            color: var(--text-color);
            padding: 0;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            overflow: hidden;
        }

        .header {
            background-color: var(--card-bg);
            padding: 16px;
            box-shadow: var(--shadow);
            position: absolute;
            top: 0;
            width: 100%;
            max-width: 600px;
            text-align: center;
            z-index: 100;
        }

        .header h1 {
            margin: 0;
            font-size: 20px;
            font-weight: 600;
            color: var(--accent-color);
        }

        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-top: 80px;
        }

        #game-board {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 20px;
        }

        .score-container {
            display: flex;
            justify-content: space-between;
            width: 300px;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: 600;
        }

        .controls {
            display: none; /* –°–∫—Ä—ã—Ç—ã –≤—Å–µ–≥–¥–∞ */
        }

        .start-btn {
            padding: 12px 24px;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
        }

        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: var(--card-bg);
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            text-align: center;
            display: none;
        }

        .instructions {
            color: var(--secondary-text);
            font-size: 14px;
            margin-top: 10px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üêç –ó–º–µ–π–∫–∞</h1>
    </div>

    <div class="game-container">
        <div class="score-container">
            <div>–°—á—ë—Ç: <span id="score">0</span></div>
            <div>–†–µ–∫–æ—Ä–¥: <span id="high-score">0</span></div>
        </div>

        <canvas id="game-board" width="300" height="300"></canvas>

        <button class="start-btn" id="start-btn">‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å</button>
        <div class="instructions">–ù–∞ –ü–ö: WASD –∏–ª–∏ —Å—Ç—Ä–µ–ª–∫–∏. –ù–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ: —Å–≤–∞–π–ø—ã –ø–æ —ç–∫—Ä–∞–Ω—É.</div>
    </div>

    <div class="game-over" id="game-over">
        <h2>–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!</h2>
        <p>–í–∞—à —Å—á—ë—Ç: <span id="final-score">0</span></p>
        <button class="start-btn" onclick="resetGame()">üîÑ –ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
    </div>

    <script>
        const canvas = document.getElementById('game-board');
        const ctx = canvas.getContext('2d');
        const scoreDisplay = document.getElementById('score');
        const highScoreDisplay = document.getElementById('high-score');
        const finalScoreDisplay = document.getElementById('final-score');
        const startBtn = document.getElementById('start-btn');
        const gameOverScreen = document.getElementById('game-over');

        const gridSize = 15;
        const tileCount = canvas.width / gridSize;

        let snake = [];
        let food = {};
        let dx = 0;
        let dy = 0;
        let score = 0;
        let highScore = localStorage.getItem('snakeHighScore') || 0;
        let gameRunning = false;
        let gameStarted = false; // –ù–æ–≤–æ–µ: –ø—Ä–æ–≤–µ—Ä–∫–∞, –Ω–∞—á–∞—Ç–∞ –ª–∏ –∏–≥—Ä–∞

        highScoreDisplay.textContent = highScore;

        function initGame() {
            snake = [{x: 10, y: 10}];
            dx = 0;
            dy = 0;
            score = 0;
            scoreDisplay.textContent = score;
            generateFood();
        }

        function drawSnake() {
            ctx.fillStyle = '#4CAF50';
            snake.forEach(segment => {
                ctx.fillRect(segment.x * gridSize, segment.y * gridSize, gridSize - 1, gridSize - 1);
            });
        }

        function drawFood() {
            ctx.fillStyle = '#FF5722';
            ctx.fillRect(food.x * gridSize, food.y * gridSize, gridSize - 1, gridSize - 1);
        }

        function moveSnake() {
            if (dx === 0 && dy === 0) return; // –ù–µ –¥–≤–∏–≥–∞–µ–º—Å—è, –µ—Å–ª–∏ –Ω–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è

            const head = {x: snake[0].x + dx, y: snake[0].y + dy};

            if (head.x < 0 || head.x >= tileCount || head.y < 0 || head.y >= tileCount) {
                gameOver();
                return;
            }

            for (let i = 0; i < snake.length; i++) {
                if (snake[i].x === head.x && snake[i].y === head.y) {
                    gameOver();
                    return;
                }
            }

            snake.unshift(head);

            if (head.x === food.x && head.y === food.y) {
                score++;
                scoreDisplay.textContent = score;
                generateFood();
            } else {
                snake.pop();
            }
        }

        function generateFood() {
            food.x = Math.floor(Math.random() * tileCount);
            food.y = Math.floor(Math.random() * tileCount);

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ–±—ã –µ–¥–∞ –Ω–µ –ø–æ—è–≤–∏–ª–∞—Å—å –Ω–∞ –∑–º–µ–π–∫–µ
            for (let segment of snake) {
                if (segment.x === food.x && segment.y === food.y) {
                    generateFood();
                    break;
                }
            }
        }

        function draw() {
            ctx.fillStyle = '#1f2023';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            drawSnake();
            drawFood();
        }

        function gameLoop() {
            if (!gameRunning) return;

            moveSnake();
            draw();

            setTimeout(gameLoop, 150);
        }

        function startGame() {
            if (gameStarted) {
                // –ï—Å–ª–∏ –∏–≥—Ä–∞ —É–∂–µ –Ω–∞—á–∞—Ç–∞, —Ç–æ —Å—Ç–∞–≤–∏–º –Ω–∞ –ø–∞—É–∑—É/—Å–Ω–∏–º–∞–µ–º —Å –ø–∞—É–∑—ã
                if (gameRunning) {
                    pauseGame();
                } else {
                    resumeGame();
                }
                return;
            }

            // –ü–µ—Ä–≤–∞—è –∏–≥—Ä–∞
            initGame();
            gameRunning = true;
            gameStarted = true;
            startBtn.textContent = '‚è∏Ô∏è –ü–∞—É–∑–∞';
            gameLoop();
        }

        function pauseGame() {
            gameRunning = false;
            startBtn.textContent = '‚ñ∂Ô∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å';
        }

        function resumeGame() {
            gameRunning = true;
            startBtn.textContent = '‚è∏Ô∏è –ü–∞—É–∑–∞';
            gameLoop();
        }

        function gameOver() {
            gameRunning = false;
            gameStarted = false; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ —Å–Ω–æ–≤–∞ –Ω–∞–∂–∞—Ç—å "–ù–∞—á–∞—Ç—å"
            startBtn.textContent = '‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å';
            finalScoreDisplay.textContent = score;

            if (score > highScore) {
                highScore = score;
                localStorage.setItem('snakeHighScore', highScore);
                highScoreDisplay.textContent = highScore;
            }

            gameOverScreen.style.display = 'block';
        }

        function resetGame() {
            gameOverScreen.style.display = 'none';
            // –ò–≥—Ä–∞ –Ω–∞—á–Ω—ë—Ç—Å—è –∑–∞–Ω–æ–≤–æ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ "–ù–∞—á–∞—Ç—å"
        }

        function changeDirection(direction) {
            if (!gameRunning || (dx === 0 && dy === 0 && !gameStarted)) return; // –ù–µ –º–µ–Ω—è–µ–º, –µ—Å–ª–∏ –∏–≥—Ä–∞ –Ω–µ –Ω–∞—á–∞—Ç–∞

            switch (direction) {
                case 'up':
                    if (dy === 0) { // –ù–µ –¥–≤–∏–≥–∞–µ–º—Å—è –≤–Ω–∏–∑
                        dx = 0;
                        dy = -1;
                    }
                    break;
                case 'down':
                    if (dy === 0) { // –ù–µ –¥–≤–∏–≥–∞–µ–º—Å—è –≤–≤–µ—Ä—Ö
                        dx = 0;
                        dy = 1;
                    }
                    break;
                case 'left':
                    if (dx === 0) { // –ù–µ –¥–≤–∏–≥–∞–µ–º—Å—è –≤–ø—Ä–∞–≤–æ
                        dx = -1;
                        dy = 0;
                    }
                    break;
                case 'right':
                    if (dx === 0) { // –ù–µ –¥–≤–∏–≥–∞–µ–º—Å—è –≤–ª–µ–≤–æ
                        dx = 1;
                        dy = 0;
                    }
                    break;
            }
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (WASD –∏ —Å—Ç—Ä–µ–ª–∫–∏)
        document.addEventListener('keydown', e => {
            if (!gameStarted) return; // –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –∏–≥—Ä–∞ –Ω–∞—á–∞—Ç–∞

            switch (e.key.toLowerCase()) {
                case 'w':
                case '—Ü':
                case 'arrowup':
                    changeDirection('up');
                    break;
                case 's':
                case '—ã':
                case 'arrowdown':
                    changeDirection('down');
                    break;
                case 'a':
                case '—Ñ':
                case 'arrowleft':
                    changeDirection('left');
                    break;
                case 'd':
                case '–≤':
                case 'arrowright':
                    changeDirection('right');
                    break;
            }
        });

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤–∞–π–ø–∞–º–∏ (–¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤)
        let touchStartX = 0;
        let touchStartY = 0;

        canvas.addEventListener('touchstart', e => {
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
            e.preventDefault(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É
        });

        canvas.addEventListener('touchmove', e => {
            e.preventDefault(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É
        });

        canvas.addEventListener('touchend', e => {
            if (!gameStarted) return; // –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –∏–≥—Ä–∞ –Ω–∞—á–∞—Ç–∞

            const touchEndX = e.changedTouches[0].clientX;
            const touchEndY = e.changedTouches[0].clientY;

            const dx = touchEndX - touchStartX;
            const dy = touchEndY - touchStartY;

            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤–∞–π–ø–∞
            if (Math.abs(dx) > Math.abs(dy)) {
                // –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–≤–∞–π–ø
                if (dx > 0) {
                    changeDirection('right');
                } else {
                    changeDirection('left');
                }
            } else {
                // –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å–≤–∞–π–ø
                if (dy > 0) {
                    changeDirection('down');
                } else {
                    changeDirection('up');
                }
            }
            e.preventDefault(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É
        });

        startBtn.addEventListener('click', startGame);
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã (–Ω–æ –Ω–µ –∑–∞–ø—É—Å–∫)
        initGame();
    </script>
</body>
</html>